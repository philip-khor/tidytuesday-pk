---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(tidyverse) 
library(readxl)
week2 <- read_excel("C:/Users/Philip/Downloads/tidy_tuesday_week2.xlsx")
skimr::skim(week2)
```

```{r}
week2 %>% group_by(year) %>% summarise(CB = mean(Cornerback), 
                                       DL = mean(`Defensive Lineman`), 
                                       LB = mean(Linebacker), 
                                       OL = mean(`Offensive Lineman`), 
                                       QB = mean(Quarterback, na.rm = TRUE), 
                                       RB = mean(`Running Back`), 
                                       SF = mean(Safety), 
                                       ST = mean(`Special Teamer`), 
                                       TE = mean(`Tight End`), 
                                       WR = mean(`Wide Receiver`)) -> week2group
```

```{r}
p1 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = Cornerback/10^6, alpha = Cornerback)) + geom_line(data = week2group, aes(year, CB/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none") + ylab(NULL) + xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'CB', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p2 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Defensive Lineman`/10^6, alpha = `Defensive Lineman`))+ geom_line(data = week2group, aes(year, DL/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none") + ylab(NULL) + xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'DL', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p3 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = Linebacker/10^6, alpha = Linebacker))+ geom_line(data = week2group, aes(year, LB/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none")+ ylab(NULL) + xlab(NULL)+ geom_text(aes(x = 2012, y = 22),label = 'LB', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p4 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Offensive Lineman`/10^6, alpha = `Offensive Lineman`))+ geom_line(data = week2group, aes(year, OL/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() +  theme(legend.position="none") + ylab(NULL) + xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'OL', size = 5) + coord_cartesian(ylim = c(0,25))+ scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p5 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = Quarterback/10^6, alpha = Quarterback))+ geom_line(data = week2group, aes(year, QB/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal()+ theme(legend.position="none") + ylab(NULL) + xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'QB', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p6 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Running Back`/10^6, alpha = `Running Back`))+ geom_line(data = week2group, aes(year, RB/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none") + ylab(NULL) + xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'RB', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p7 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = Safety/10^6, alpha = Safety))+ geom_line(data = week2group, aes(year, SF/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal()+ theme(legend.position="none") + ylab(NULL)+ xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'SF', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p8 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Special Teamer`/10^6, alpha = `Special Teamer`))+ geom_line(data = week2group, aes(year, ST/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none")+ ylab(NULL) + xlab(NULL)+ geom_text(aes(x = 2012, y = 22),label = 'ST', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p9 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Tight End`/10^6, alpha = `Tight End`))+ geom_line(data = week2group, aes(year, TE/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal()+ theme(legend.position="none")+ ylab(NULL)+ xlab(NULL) + geom_text(aes(x = 2012, y = 22),label = 'TE', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

p10 <- ggplot() + geom_jitter(data = week2, aes(x = year, y = `Wide Receiver`/10^6, alpha = `Wide Receiver`))+ geom_line(data = week2group, aes(year, WR/10^6, group = 1), color = 'blue', size = 1) + scale_alpha(range = c(0.2, 0.1)) + theme_minimal() + theme(legend.position="none") + ylab(NULL) + xlab(NULL)+ geom_text(aes(x = 2012, y = 22),label = 'WR', size = 5) + coord_cartesian(ylim = c(0,25)) + scale_x_continuous(breaks = c(2011, 2014, 2017), labels = c(paste0('\'', 11), paste0('\'', 14),paste0('\'', 17)))

library(gridExtra)
grid1 <- grid.arrange(p6, p5, p4, p9, p7, nrow = 1, top = 'OFFENSE')
grid2 <- grid.arrange(p1, p2, p3, p8, p10, nrow = 1, top = 'DEFENSE')
grid.arrange(grid1, grid2, ncol = 1, top = 'Average cap value of 16 highest-paid players in each position')
```
```{r}
ml <- arrangeGrob(grid1, grid2, ncol = 1, top = textGrob('Average cap value of 16 highest-paid players in each position', x = 0, y = 0, just = 'left', gp = gpar(fontface = 'bold', fontsize = 15)))
ggsave('week2.pdf', ml)
```